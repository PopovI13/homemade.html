<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simple Shooter Game</title>
<style>
  body {
    margin: 0;
    background: #000;
    overflow: hidden;
  }
  canvas {
    display: block;
    margin: auto;
    background: #111;
  }
  #info {
    color: white;
    font-family: monospace;
    text-align: center;
    margin: 5px;
  }
</style>
</head>
<body>
<div id="info">Use Arrow Keys to move, Space to shoot</div>
<canvas id="game"></canvas>

<script>
// Set up canvas and context
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = 600;
canvas.height = 400;

// Game state variables
let keys = {};
let bullets = [];
let enemies = [];
let bonuses = [];
let explosions = [];
let trails = [];
let score = 0;
let lives = 3;
let gameOver = false;
let lastEnemySpawn = 0;
let enemySpawnInterval = 1500;
let lastBonusSpawn = 0;
let bonusSpawnInterval = 10000;
let playerSpeed = 3;
let rapidFire = false;
let rapidFireTimeout = null;
let megaExplosion = false;
let megaExplosionTimeout = null;
let shakeDuration = 0;

// Player object
const player = {
  x: canvas.width / 2 - 15,
  y: canvas.height - 50,
  width: 30,
  height: 30,
  speed: playerSpeed,
  color: 'cyan',
  canShoot: true,
  shootCooldown: 400,
  lastShot: 0
};

// Keyboard events
window.addEventListener('keydown', e => {
  keys[e.code] = true;
});

window.addEventListener('keyup', e => {
  keys[e.code] = false;
});

// Utility functions
function rectsCollide(r1, r2) {
  return !(
    r1.x > r2.x + r2.width ||
    r1.x + r1.width < r2.x ||
    r1.y > r2.y + r2.height ||
    r1.y + r1.height < r2.y
  );
}

function spawnEnemy() {
  const size = 25;
  enemies.push({
    x: Math.random() * (canvas.width - size),
    y: -size,
    width: size,
    height: size,
    speed: 2 + Math.random() * 1.5,
    color: 'red'
  });
}

function spawnBonus() {
  const size = 20;
  const types = ['speed', 'rapid', 'mega'];
  const type = types[Math.floor(Math.random() * types.length)];
  bonuses.push({
    x: Math.random() * (canvas.width - size),
    y: -size,
    width: size,
    height: size,
    speed: 1.5,
    type,
    color: type === 'speed' ? 'lime' : (type === 'rapid' ? 'yellow' : 'magenta')
  });
}

function addExplosion(x, y) {
  explosions.push({
    x,
    y,
    radius: 0,
    maxRadius: 40,
    alpha: 1
  });
  shakeDuration = 10;
}

function drawPlayer() {
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawBullets() {
  ctx.fillStyle = 'white';
  bullets.forEach(b => ctx.fillRect(b.x, b.y, b.width, b.height));
}

function drawEnemies() {
  enemies.forEach(e => {
    ctx.fillStyle = e.color;
    ctx.fillRect(e.x, e.y, e.width, e.height);
  });
}

function drawBonuses() {
  bonuses.forEach(b => {
    ctx.fillStyle = b.color;
    ctx.fillRect(b.x, b.y, b.width, b.height);
  });
}

function drawExplosions() {
  explosions.forEach(exp => {
    ctx.beginPath();
    ctx.fillStyle = `rgba(255,165,0,${exp.alpha})`;
    ctx.arc(exp.x, exp.y, exp.radius, 0, Math.PI * 2);
    ctx.fill();
  });
}

function drawHUD() {
  ctx.fillStyle = 'white';
  ctx.font = '18px monospace';
  ctx.fillText(`Score: ${score}`, 10, 20);
  ctx.fillText(`Lives: ${lives}`, 10, 40);
  if (rapidFire) ctx.fillText('Rapid Fire ON', 10, 60);
  if (megaExplosion) ctx.fillText('Mega Explosion ON', 10, 80);
  if (playerSpeed > 3) ctx.fillText('Speed Boost ON', 10, 100);
}

// Update functions
function updatePlayer() {
  if (keys['ArrowLeft'] && player.x > 0) {
    player.x -= player.speed;
  }
  if (keys['ArrowRight'] && player.x + player.width < canvas.width) {
    player.x += player.speed;
  }
  if (keys['ArrowUp'] && player.y > 0) {
    player.y -= player.speed;
  }
  if (keys['ArrowDown'] && player.y + player.height < canvas.height) {
    player.y += player.speed;
  }
  if (keys['Space']) {
    const now = Date.now();
    if (player.canShoot && now - player.lastShot > player.shootCooldown) {
      bullets.push({
        x: player.x + player.width / 2 - 3,
        y: player.y,
        width: 6,
        height: 12,
        speed: 7,
        color: 'white'
      });
      player.lastShot = now;
    }
  }
}

function updateBullets() {
  bullets = bullets.filter(b => b.y + b.height > 0);
  bullets.forEach(b => b.y -= b.speed);
}

function updateEnemies() {
  enemies.forEach(e => e.y += e.speed);
  enemies = enemies.filter(e => e.y < canvas.height + e.height);
}

function updateBonuses() {
  bonuses.forEach(b => b.y += b.speed);
  bonuses = bonuses.filter(b => b.y < canvas.height + b.height);
}

function updateExplosions() {
  explosions.forEach((exp, i) => {
    exp.radius += 3;
    exp.alpha -= 0.05;
    if (exp.alpha <= 0) explosions.splice(i, 1);
  });
}

function checkCollisions() {
  // Bullet hits enemy
  bullets.forEach((b, bi) => {
    enemies.forEach((e, ei) => {
      if (rectsCollide(b, e)) {
        addExplosion(e.x + e.width/2, e.y + e.height/2);
        score += 10;
        enemies.splice(ei, 1);
        bullets.splice(bi, 1);
      }
    });
  });

  // Enemy hits player
  enemies.forEach((e, ei) => {
    if (rectsCollide(e, player)) {
      addExplosion(player.x + player.width/2, player.y + player.height/2);
      lives--;
      enemies.splice(ei, 1);
      if (lives <= 0) gameOver = true;
    }
  });

  // Player collects bonus
  bonuses.forEach((b, bi) => {
    if (rectsCollide(b, player)) {
      if (b.type === 'speed') {
        player.speed = 6;
        setTimeout(() => player.speed = 3, 5000);
      }
      if (b.type === 'rapid') {
        player.shootCooldown = 100;
        setTimeout(() => player.shootCooldown = 400, 5000);
      }
      if (b.type === 'mega') {
        megaExplosion = true;
        setTimeout(() => megaExplosion = false, 5000);
      }
      bonuses.splice(bi, 1);
    }
  });
}

function gameLoop(timestamp) {
  if (gameOver) {
    ctx.fillStyle = 'white';
    ctx.font = '48px monospace';
    ctx.textAlign = 'center';
    ctx.fillText('GAME OVER', canvas.width / 2, canvas.height / 2);
    ctx.font = '24px monospace';
    ctx.fillText(`Score: ${score}`, canvas.width / 2, canvas.height / 2 + 40);
    return;
  }

  // Shake effect
  if (shakeDuration > 0) {
    const dx = (Math.random() - 0.5) * 10;
    const dy = (Math.random() - 0.5) * 10;
    ctx.setTransform(1, 0, 0, 1, dx, dy);
    shakeDuration--;
  } else {
    ctx.setTransform(1, 0, 0, 1, 0, 0);
  }

  // Clear screen
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Spawn enemies and bonuses
  if (timestamp - lastEnemySpawn > enemySpawnInterval) {
    spawnEnemy();
    lastEnemySpawn = timestamp;
  }
  if (timestamp - lastBonusSpawn > bonusSpawnInterval) {
    spawnBonus();
    lastBonusSpawn = timestamp;
  }

  // Update everything
  updatePlayer();
  updateBullets();
  updateEnemies();
  updateBonuses();
  updateExplosions();
  checkCollisions();

  // Mega explosion effect (destroy all enemies on screen)
  if (megaExplosion) {
    enemies.forEach(e => addExplosion(e.x + e.width/2, e.y + e.height/2));
    enemies = [];
  }

  // Draw everything
  drawPlayer();
  drawBullets();
  drawEnemies();
  drawBonuses();
  drawExplosions();
  drawHUD();

  requestAnimationFrame(gameLoop);
}

// Start the game
requestAnimationFrame(gameLoop);

</script>
</body>
</html>

